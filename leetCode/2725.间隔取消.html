<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2725. 间隔取消</title>
  </head>
  <body>
    <script>
      // https://leetcode.cn/problems/interval-cancellation/description/

      // 现给定一个函数 fn，一个参数数组 args 和一个时间间隔 t，返回一个取消函数 cancelFn。
      // 在经过 cancelTimeMs 毫秒的延迟后，将调用返回的取消函数 cancelFn。
      // setTimeout(cancelFn, cancelTimeMs)
      // 函数 fn 应立即使用参数 args 调用，然后每隔 t 毫秒调用一次，直到在 cancelTimeMs 毫秒时调用 cancelFn。
      //
      // 提示：
      // fn 是一个函数
      // args 是一个有效的 JSON 数组
      // 1 <= args.length <= 10
      // 30 <= t <= 100
      // 10 <= cancelT <= 500

      /**
       * @param {Function} fn
       * @param {Array} args
       * @param {number} t
       * @return {Function}
       */
      var cancellable = function (fn, args, t) {};

      /**
       *  const result = [];
       *
       *  const fn = (x) => x * 2;
       *  const args = [4], t = 35, cancelTimeMs = 190;
       *
       *  const start = performance.now();
       *
       *  const log = (...argsArr) => {
       *      const diff = Math.floor(performance.now() - start);
       *      result.push({"time": diff, "returned": fn(...argsArr)});
       *  }
       *
       *  const cancel = cancellable(log, args, t);
       *
       *  setTimeout(cancel, cancelTimeMs);
       *
       *  setTimeout(() => {
       *      console.log(result); // [
       *                           //     {"time":0,"returned":8},
       *                           //     {"time":35,"returned":8},
       *                           //     {"time":70,"returned":8},
       *                           //     {"time":105,"returned":8},
       *                           //     {"time":140,"returned":8},
       *                           //     {"time":175,"returned":8}
       *                           // ]
       *  }, cancelTimeMs + t + 15)
       */

      // --- answer-1 ---

      var cancellable = function (fn, args, t) {
        fn(...args);
        const timer = setInterval(() => fn(...args), t);

        const cancelFn = () => clearInterval(timer);
        return cancelFn;
      };

      // --- answer-1 ---

      // --- answer-2 ---

      // --- answer-2 ---

      var fn = (x) => x * 2,
        args = [4],
        t = 35,
        cancelT = 190;
      var result = [
        { time: 0, returned: 8 },
        { time: 35, returned: 8 },
        { time: 70, returned: 8 },
        { time: 105, returned: 8 },
        { time: 140, returned: 8 },
        { time: 175, returned: 8 }
      ];

      var fn = (x1, x2) => x1 * x2,
        args = [2, 5],
        t = 30,
        cancelT = 165;
      var result = [
        { time: 0, returned: 10 },
        { time: 30, returned: 10 },
        { time: 60, returned: 10 },
        { time: 90, returned: 10 },
        { time: 120, returned: 10 },
        { time: 150, returned: 10 }
      ];

      console.log('fn = ', fn);
      console.log('args = ', args);
      console.log('t = ', t);
      console.log('cancelT = ', cancelT);
      console.log('result = ', result);
      console.log('sortBy = ', cancellable(fn, args, t));
    </script>
  </body>
</html>
